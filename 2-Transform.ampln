{"doc_type":"Amphi Pipeline","version":"1","json_schema":"http://docs.amphi.ai/schemas/pipeline-v1-schema.json","id":"pipeline_1742151397012","pipelines":[{"id":"primary","flow":{"nodes":[{"id":"node_1742152613967","type":"csvFileInput","position":{"x":0,"y":150},"data":{"fileLocation":"local","connectionMethod":"env","csvOptions":{"sep":",","engine":"pyarrow"},"nameId":"csvFileInput1","lastUpdated":0,"filePath":"data/bigquery_hist_sales/Sales_*_5.csv","lastExecuted":0,"successfulExecution":true},"positionAbsolute":{"x":0,"y":150},"width":196,"height":136,"selected":false,"dragging":false},{"id":"node_1742153066373","type":"rename","position":{"x":255,"y":150},"data":{"nameId":"rename1","lastUpdated":0,"columns":[{"key":{"value":"Quantity Ordered","type":"Int64","named":true},"value":"Quantity_Ordered"},{"key":{"value":"Price Each","type":"Float64","named":true},"value":"Price_Each"},{"key":{"value":"Order Date","type":"object","named":true},"value":"Order_Date"},{"key":{"value":"Purchase Address","type":"string","named":true},"value":"Purchase_Address"}],"lastExecuted":0,"successfulExecution":true},"positionAbsolute":{"x":255,"y":150},"width":196,"height":136,"selected":false,"dragging":false},{"id":"node_1742153197650","type":"filterColumn","position":{"x":540,"y":150},"data":{"columns":{"sourceData":[{"value":"Product","label":"Product","type":"string","named":true,"key":"Product","title":"Product"},{"value":"Quantity_Ordered","label":"Quantity_Ordered","type":"Int64","named":true,"key":"Quantity_Ordered","title":"Quantity_Ordered"},{"value":"Price_Each","label":"Price_Each","type":"Float64","named":true,"key":"Price_Each","title":"Price_Each"},{"value":"Order_Date","label":"Order_Date","type":"object","named":true,"key":"Order_Date","title":"Order_Date"},{"value":"Purchase_Address","label":"Purchase_Address","type":"string","named":true,"key":"Purchase_Address","title":"Purchase_Address"},{"value":"Category","label":"Category","type":"string","named":true,"key":"Category","title":"Category"}],"targetKeys":["Quantity_Ordered","Price_Each","Order_Date","Purchase_Address","Category"]},"nameId":"filterColumn1","lastUpdated":0,"lastExecuted":0,"successfulExecution":true},"positionAbsolute":{"x":540,"y":150},"width":196,"height":136,"selected":false,"dragging":false},{"id":"node_1742153323220","type":"filter","position":{"x":840,"y":105},"data":{"condition":"==","nameId":"filter1","lastUpdated":0,"column":{"value":"Category","type":"string","named":true},"conditionValue":"Monitores","lastExecuted":0,"successfulExecution":true},"positionAbsolute":{"x":840,"y":105},"width":196,"height":136,"selected":false,"dragging":false},{"id":"node_1742153500090","type":"splitColumn","position":{"x":1140,"y":105},"data":{"splitType":"columns","regex":false,"keepOriginalColumn":false,"nameId":"splitColumn1","lastUpdated":0,"column":{"value":"Purchase_Address","type":"string","named":true},"delimiter":",","lastExecuted":0,"successfulExecution":true},"positionAbsolute":{"x":1140,"y":105},"width":196,"height":136,"selected":false,"dragging":false},{"id":"node_1742153655782","type":"filterColumn","position":{"x":1410,"y":105},"data":{"columns":{"sourceData":[{"value":"Quantity_Ordered","label":"Quantity_Ordered","type":"Int64","named":true,"key":"Quantity_Ordered","title":"Quantity_Ordered"},{"value":"Price_Each","label":"Price_Each","type":"Float64","named":true,"key":"Price_Each","title":"Price_Each"},{"value":"Order_Date","label":"Order_Date","type":"object","named":true,"key":"Order_Date","title":"Order_Date"},{"value":"Category","label":"Category","type":"string","named":true,"key":"Category","title":"Category"},{"value":"Purchase_Address_0","label":"Purchase_Address_0","type":"string","named":true,"key":"Purchase_Address_0","title":"Purchase_Address_0"},{"value":"Purchase_Address_1","label":"Purchase_Address_1","type":"string","named":true,"key":"Purchase_Address_1","title":"Purchase_Address_1"},{"value":"Purchase_Address_2","label":"Purchase_Address_2","type":"string","named":true,"key":"Purchase_Address_2","title":"Purchase_Address_2"}],"targetKeys":["Quantity_Ordered","Price_Each","Order_Date","Purchase_Address_1"]},"nameId":"filterColumn2","lastUpdated":0,"lastExecuted":0,"successfulExecution":true},"positionAbsolute":{"x":1410,"y":105},"width":196,"height":136,"selected":false,"dragging":false},{"id":"node_1742153811165","type":"formulaRow","position":{"x":1680,"y":30},"data":{"nameId":"formulaRow1","lastUpdated":0,"formulas":[{"columns":[{"type":["numeric","float","float64"],"named":true,"value":"Sales"}],"formula":"row['Quantity_Ordered'] * row['Price_Each']","type":"expr"}],"lastExecuted":0,"successfulExecution":true},"width":196,"height":136,"selected":false,"positionAbsolute":{"x":1680,"y":30},"dragging":false},{"id":"node_1742154355937","type":"join","position":{"x":2415,"y":75},"data":{"how":"left","nameId":"join1","lastUpdated":0,"lastExecuted":0,"leftKeyColumn":[{"type":"string","named":true,"value":"Purchase_Address_1"}],"rightKeyColumn":[{"type":"string","named":true,"value":"Ciudad"}],"successfulExecution":true},"positionAbsolute":{"x":2415,"y":75},"width":196,"height":136,"selected":false,"dragging":false},{"id":"node_1742154423732","type":"csvFileInput","position":{"x":1725,"y":375},"data":{"fileLocation":"local","connectionMethod":"env","csvOptions":{"sep":","},"nameId":"csvFileInput2","lastUpdated":0,"filePath":"data/clasificacion de region.csv","lastExecuted":0,"successfulExecution":true},"positionAbsolute":{"x":1725,"y":375},"width":196,"height":136,"selected":false,"dragging":false},{"id":"node_1742154923526","type":"cleanDataCLeansing","position":{"x":1935,"y":30},"data":{"method":"value","value":0,"forward":false,"backward":false,"nameId":"cleanDataCLeansing1","lastUpdated":0,"columns":[{"type":"string","named":true,"value":"Purchase_Address_1"}],"removeUnwantedCharacters":["whitespace"],"lastExecuted":0,"successfulExecution":true},"positionAbsolute":{"x":1935,"y":30},"width":196,"height":136,"selected":false,"dragging":false},{"id":"node_1742155235371","type":"formulaRow","position":{"x":2040,"y":345},"data":{"nameId":"formulaRow2","lastUpdated":0,"formulas":[{"columns":[{"type":"string","named":true,"value":"Ciudad"}],"formula":"'New York City' if row['Ciudad'] == 'Nueva York' else row['Ciudad']","type":"expr"},{"columns":[{"type":"string","named":true,"value":"Ciudad"}],"formula":"def fix_ciudades(row):\n  if row['Ciudad'] == 'Nueva York':\n    return 'New York City'\n  elif row['Ciudad'] == 'Los Ángeles':\n    return 'Los Angeles'\n  else: \n    return row['Ciudad']","type":"function"}],"lastExecuted":0,"successfulExecution":true},"width":196,"height":136,"selected":false,"positionAbsolute":{"x":2040,"y":345},"dragging":false},{"id":"node_1742156305407","type":"aggregate","position":{"x":2760,"y":225},"data":{"nameId":"aggregate1","lastUpdated":0,"groupByColumns":[{"type":"object","named":true,"value":"Order_Date"},{"type":"string","named":true,"value":"Región"}],"columnsOperations":[{"key":{"value":"Sales","type":"float64","named":true},"value":{"label":"Sum","value":"sum","key":"sum"}}],"lastExecuted":0,"successfulExecution":true},"positionAbsolute":{"x":2760,"y":225},"width":196,"height":136,"selected":false,"dragging":false},{"id":"node_1742156423393","type":"pivot","position":{"x":3090,"y":240},"data":{"aggfunc":"none","fillValue":0,"nameId":"pivot1","lastUpdated":0,"customTitle":"Reporte por region","indexColumns":[{"type":"object","named":true,"value":"Order_Date"}],"columnsToPivot":[{"type":"string","named":true,"value":"Región"}],"values":[{"type":"float64","named":true,"value":"Sales_sum"}],"lastExecuted":0,"successfulExecution":true},"positionAbsolute":{"x":3090,"y":240},"width":196,"height":136,"selected":false,"dragging":false},{"id":"node_1742156598600","type":"transpose","position":{"x":3405,"y":270},"data":{"order":"True","nameId":"transpose1","lastUpdated":0,"key":[{"type":"object","named":true,"value":"Order_Date"}],"columns":[{"type":"float64","named":true,"value":"Noreste (Atlántico Medio)"},{"type":"float64","named":true,"value":"Noreste (Nueva Inglaterra)"},{"type":"float64","named":true,"value":"Oeste (Costa del Pacífico)"},{"type":"float64","named":true,"value":"Sur (Centro-Sur)"},{"type":"float64","named":true,"value":"Sur (Sureste)"}],"lastExecuted":0,"successfulExecution":true},"positionAbsolute":{"x":3405,"y":270},"width":196,"height":136,"selected":false,"dragging":false},{"id":"node_1742156666754","type":"typeConverter","position":{"x":3795,"y":270},"data":{"dataType":["datetime","datetime64[ns]"],"nameId":"typeConverter1","lastUpdated":0,"column":{"value":"Order_Date","type":"object","named":true},"lastExecuted":0,"successfulExecution":true},"positionAbsolute":{"x":3795,"y":270},"width":196,"height":136,"selected":false,"dragging":false},{"id":"node_1742156765871","type":"datetimeConverter","position":{"x":4125,"y":255},"data":{"conversionType":"dateToString","language":"es_ES.UTF-8","dateTimeFormat":"%A, %d %B %Y","nameId":"datetimeConverter1","lastUpdated":0,"dateTimeField":{"value":"Order_Date","type":"datetime64[ns]","named":true},"lastExecuted":0,"successfulExecution":true},"positionAbsolute":{"x":4125,"y":255},"width":196,"height":136,"selected":false,"dragging":false},{"id":"node_1742269563411","type":"csvFileOutput","position":{"x":4470,"y":240},"data":{"fileLocation":"local","connectionMethod":"env","csvOptions":{"sep":",","header":true,"index":false,"mode":"w"},"nameId":"csvFileOutput1","lastUpdated":0,"filePath":"data/data_final.csv","lastExecuted":0,"successfulExecution":true},"positionAbsolute":{"x":4470,"y":240},"width":196,"height":136,"selected":true,"dragging":false}],"edges":[{"source":"node_1742152613967","sourceHandle":"out","target":"node_1742153066373","targetHandle":"in","type":"custom-edge","id":"reactflow__edge-node_1742152613967out-node_1742153066373in"},{"source":"node_1742153066373","sourceHandle":"out","target":"node_1742153197650","targetHandle":"in","type":"custom-edge","id":"reactflow__edge-node_1742153066373out-node_1742153197650in"},{"source":"node_1742153197650","sourceHandle":"out","target":"node_1742153323220","targetHandle":"in","type":"custom-edge","id":"reactflow__edge-node_1742153197650out-node_1742153323220in"},{"source":"node_1742153323220","sourceHandle":"out","target":"node_1742153500090","targetHandle":"in","type":"custom-edge","id":"reactflow__edge-node_1742153323220out-node_1742153500090in"},{"source":"node_1742153500090","sourceHandle":"out","target":"node_1742153655782","targetHandle":"in","type":"custom-edge","id":"reactflow__edge-node_1742153500090out-node_1742153655782in"},{"source":"node_1742153655782","sourceHandle":"out","target":"node_1742153811165","targetHandle":"in","type":"custom-edge","id":"reactflow__edge-node_1742153655782out-node_1742153811165in"},{"source":"node_1742153811165","sourceHandle":"out","target":"node_1742154923526","targetHandle":"in","type":"custom-edge","id":"reactflow__edge-node_1742153811165out-node_1742154923526in"},{"source":"node_1742154923526","sourceHandle":"out","target":"node_1742154355937","targetHandle":"in1","type":"custom-edge","id":"reactflow__edge-node_1742154923526out-node_1742154355937in1"},{"source":"node_1742154423732","sourceHandle":"out","target":"node_1742155235371","targetHandle":"in","type":"custom-edge","id":"reactflow__edge-node_1742154423732out-node_1742155235371in"},{"source":"node_1742155235371","sourceHandle":"out","target":"node_1742154355937","targetHandle":"in2","type":"custom-edge","id":"reactflow__edge-node_1742155235371out-node_1742154355937in2"},{"source":"node_1742154355937","sourceHandle":"out","target":"node_1742156305407","targetHandle":"in","type":"custom-edge","id":"reactflow__edge-node_1742154355937out-node_1742156305407in"},{"source":"node_1742156305407","sourceHandle":"out","target":"node_1742156423393","targetHandle":"in","type":"custom-edge","id":"reactflow__edge-node_1742156305407out-node_1742156423393in"},{"source":"node_1742156423393","sourceHandle":"out","target":"node_1742156598600","targetHandle":"in","type":"custom-edge","id":"reactflow__edge-node_1742156423393out-node_1742156598600in"},{"source":"node_1742156598600","sourceHandle":"out","target":"node_1742156666754","targetHandle":"in","type":"custom-edge","id":"reactflow__edge-node_1742156598600out-node_1742156666754in"},{"source":"node_1742156666754","sourceHandle":"out","target":"node_1742156765871","targetHandle":"in","type":"custom-edge","id":"reactflow__edge-node_1742156666754out-node_1742156765871in"},{"source":"node_1742156765871","sourceHandle":"out","target":"node_1742269563411","targetHandle":"in","type":"custom-edge","id":"reactflow__edge-node_1742156765871out-node_1742269563411in"}],"viewport":{"x":-2411.006562320601,"y":-38.724261310516795,"zoom":0.6015125180410582}},"app_data":{"ui_data":{"comments":[]},"version":1,"runtime_type":"LOCAL"},"runtime_ref":"python"}]}